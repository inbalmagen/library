<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
</head>

<body>
    <h1>My library</h1>
    <div id="library"></div>
    <a href="about.html">About</a><br>
    ISBN : <input id="ISBN"><br>
    book_name: <input id="bookName"><br>
    author_name:<input id="authorName"><br>
    publish_date: <input id="publishDate"><br>
    publisher: <input id="publisher"><br>
    <button onclick="newBook()">add new book</button>
    <script>
        const MY_SERVER = 'http://127.0.0.1:5000'
        const newBook = async () => {
            data = {
                ISBN: ISBN.value,
                bookName: bookName.value,
                authorName: authorName.value,
                publishDate: publishDate.value,
                publisher: publisher.value
                
            }
            books1 = await axios.post(MY_SERVER + "/newbook", data)
            loadData()
        }

        const delBooks = async (id) => {
            books1 = await axios.delete(MY_SERVER + `/delBooks/${id}`)
            await loadData()
        }
        const updBooks = async (id) => {
            console.log(id);
            data = {
                ISBN: ISBN.value,
                bookName: bookName.value,
                authorName: authorName.value,
                publishDate: publishDate.value,
                publisher: publisher.value
            }
            books1 = await axios.put(MY_SERVER + `/updBooks/${id}`, data)
            loadData()
        }

        const loadData = async () => {
            books1 = await axios.get(MY_SERVER + `/book`)
            console.log(books1.data);
            library.innerHTML = books1.data.map(book => `<div>
                <button onClick='delBooks(${book.id})'>del ${book.id}</button>
                <button onClick='updBooks(${book.id})'>UPD ${book.id}</button>
                ${book.ISBN},
                ${book.book_name},
                ${book.author_name},
                ${book.publish_date},
                ${book.publisher},
                </div>`).join("")
        }
        loadData()
    </script>

</body>

</html>